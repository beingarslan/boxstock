import{G as P,r as f,z as R,p as E,e as i,X as y,a as d,o as L,c as M,b as r,d as o,w as n,t as g,h as c,ab as O}from"./app.67f4f754.js";const V={class:"retailers text-right mt-[100px] mb-[10px]"},$={class:"container"},F={class:"flex items-center flex-wrap gap-[20px] mb-[20px]"},G=r("span",null,"Company name: ",-1),H=["src"],X=c("Edit"),j=c("Delete"),q={class:"user_udpate_form"},J=c("Update"),K=c("Cancel"),Y={name:"Admin",setup(Q){const p=P(),m=f(!1),x=f();let b=[];const w=[{title:"",dataIndex:"image",slots:{customRender:"image"}},{title:"Company name",dataIndex:"company_name"},{title:"Email",dataIndex:"email",slots:{customRender:"email"}},{title:"Action",dataIndex:"operation",slots:{customRender:"operation"}}],k=s=>{x.value=s,m.value=!0,C(s)},C=s=>{let e=localStorage.getItem("token");e&&i.get("/auth/user/"+s,{headers:{Authorization:"Bearer "+e}}).then(l=>{t.user_id=l.data.user.id,t.user_name=l.data.user.user_name,t.company_name=l.data.user.company_name,t.phone_number=l.data.user.phone_number,t.password=l.data.user.password,t.approved=l.data.user.approved===1}).catch(l=>{p.dispatch("removeUser",0),p.dispatch("removeToken",0)})},_=f([]),t=R({user_id:"",user_name:"",company_name:"",phone_number:"",password:"",approved:!1}),U=()=>{let s=localStorage.getItem("token");i({method:"POST",url:"/auth/update/"+t.user_id,headers:{Authorization:"Bearer "+s},data:O(t)}).then(e=>{v(),window.location.reload()})},v=()=>{m.value=!1},S=s=>{let e=localStorage.getItem("token");i({method:"POST",url:"/auth/delete/"+s,headers:{Authorization:"Bearer "+e}}).then(l=>{v(),window.location.reload()})},A=s=>{_.value=b.filter(e=>e.company_name.toLowerCase().indexOf(s.target.value.toLowerCase())>-1)};return E(()=>{let s=localStorage.getItem("token");i.get("/auth/user-profile",{headers:{Authorization:"Bearer "+s}}).then(e=>{e.data.type!=="admin"&&y.push("/login")}),s?i.get("/auth/users",{headers:{Authorization:"Bearer "+s}}).then(e=>{_.value=e.data.user,b=e.data.user}).catch(e=>{p.dispatch("removeUser",0),p.dispatch("removeToken",0)}):y.push("/login")}),(s,e)=>{const l=d("a-button"),B=d("a-table"),h=d("a-input"),u=d("a-form-item"),I=d("a-switch"),z=d("a-input-password"),T=d("a-form"),D=d("a-modal");return L(),M("div",V,[r("div",$,[r("div",F,[r("div",null,[G,r("input",{onInput:e[0]||(e[0]=a=>A(a)),class:"py-[10px] border border-[#f5f5f5] px-[10px]",type:"text",placeholder:"Filter by company name"},null,32)])]),o(B,{columns:w,"data-source":_.value,bordered:""},{image:n(({record:a})=>[r("img",{class:"w-[60px] h-[60px] rounded-full",src:a.image,alt:"image"},null,8,H)]),company_name:n(({record:a})=>[r("a",null,g(a.company_name),1)]),email:n(({record:a})=>[r("span",null,g(a.email),1)]),operation:n(({record:a})=>[o(l,{class:"mr-[10px]",type:"primary",onClick:N=>k(a.id)},{default:n(()=>[X]),_:2},1032,["onClick"]),o(l,{class:"mr-[10px]",type:"danger",onClick:N=>S(a.id)},{default:n(()=>[j]),_:2},1032,["onClick"])]),_:1},8,["data-source"])]),o(D,{visible:m.value,"onUpdate:visible":e[6]||(e[6]=a=>m.value=a),title:"User update"},{default:n(()=>[r("div",q,[o(T,{model:t},{default:n(()=>[o(u,{label:"Company name"},{default:n(()=>[o(h,{value:t.company_name,"onUpdate:value":e[1]||(e[1]=a=>t.company_name=a)},null,8,["value"])]),_:1}),o(u,{label:"User name"},{default:n(()=>[o(h,{value:t.user_name,"onUpdate:value":e[2]||(e[2]=a=>t.user_name=a)},null,8,["value"])]),_:1}),o(u,{label:"Phone number"},{default:n(()=>[o(h,{value:t.phone_number,"onUpdate:value":e[3]||(e[3]=a=>t.phone_number=a)},null,8,["value"])]),_:1}),o(u,{label:"Approved ?"},{default:n(()=>[o(I,{checked:t.approved,"onUpdate:checked":e[4]||(e[4]=a=>t.approved=a)},null,8,["checked"])]),_:1}),o(u,{label:"Password"},{default:n(()=>[o(z,{value:t.password,"onUpdate:value":e[5]||(e[5]=a=>t.password=a),placeholder:"password"},null,8,["value"])]),_:1}),o(u,{"wrapper-col":{span:14,offset:4}},{default:n(()=>[o(l,{type:"primary",onClick:U},{default:n(()=>[J]),_:1}),o(l,{style:{"margin-left":"10px"},onClick:v},{default:n(()=>[K]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible"])])}}};export{Y as default};
