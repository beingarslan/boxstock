import{x as O,i as q,ac as Q,r as A,p as K,y as W,ad as J,ae as X,m as j,A as z,_ as Y,a8 as Z,a9 as $,aa as ee,z as te,a as _,o as I,c as L,b as p,d as f,w as v,e as P,ab as R,t as ne,f as D,Q as N,h as E}from"./app.67f4f754.js";var oe=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ae=function(e){return oe.map(function(n){return n.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ie=function(e,n,o){Object.keys(n).filter(ae).forEach(function(t){var l=n[t];typeof l=="function"&&(t==="onInit"?l(e,o):o.on(t.substring(2),function(d){return l(d,o)}))})},re=function(e,n,o,t){var l=e.modelEvents?e.modelEvents:null,d=Array.isArray(l)?l.join(" "):l;O(t,function(u,c){o&&typeof u=="string"&&u!==c&&u!==o.getContent({format:e.outputFormat})&&o.setContent(u)}),o.on(d||"change input undo redo",function(){n.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},le=function(e,n,o,t,l,d){t.setContent(d()),o.attrs["onUpdate:modelValue"]&&re(n,o,t,l),ie(e,o.attrs,t)},T=0,G=function(e){var n=Date.now(),o=Math.floor(Math.random()*1e9);return T++,e+"_"+o+T+String(n)},se=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},F=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},de=function(e,n){return F(e).concat(F(n))},ce=function(e){return e==null},H=function(){return{listeners:[],scriptId:G("tiny-script"),scriptLoaded:!1}},ue=function(){var e=H(),n=function(l,d,u,c){var r=d.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=l,r.src=u;var g=function(){r.removeEventListener("load",g),c()};r.addEventListener("load",g),d.head&&d.head.appendChild(r)},o=function(l,d,u){e.scriptLoaded?u():(e.listeners.push(u),l.getElementById(e.scriptId)||n(e.scriptId,l,d,function(){e.listeners.forEach(function(c){return c()}),e.scriptLoaded=!0}))},t=function(){e=H()};return{load:o,reinitialize:t}},me=ue(),fe=function(){return typeof window<"u"?window:global},C=function(){var e=fe();return e&&e.tinymce?e.tinymce:null},ve={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},w=globalThis&&globalThis.__assign||function(){return w=Object.assign||function(e){for(var n,o=1,t=arguments.length;o<t;o++){n=arguments[o];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},w.apply(this,arguments)},ge=function(e,n,o,t){return e(t||"div",{id:n,ref:o})},pe=function(e,n,o){return e("textarea",{id:n,visibility:"hidden",ref:o})},he=q({props:ve,setup:function(e,n){var o=e.init?w({},e.init):{},t=Q(e),l=t.disabled,d=t.modelValue,u=t.tagName,c=A(null),r=null,g=e.id||G("tiny-vue"),b=e.init&&e.init.inline||e.inline,k=!!n.attrs["onUpdate:modelValue"],h=!0,B=e.initialValue?e.initialValue:"",i="",x=function(a){return k?function(){return d!=null&&d.value?d.value:""}:function(){return a?B:i}},S=function(){var a=x(h),s=w(w({},o),{readonly:e.disabled,selector:"#"+g,plugins:de(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:b,setup:function(y){r=y,y.on("init",function(V){return le(V,e,n,y,d,a)}),typeof o.setup=="function"&&o.setup(y)}});se(c.value)&&(c.value.style.visibility=""),C().init(s),h=!1};O(l,function(a){var s;r!==null&&(typeof((s=r.mode)===null||s===void 0?void 0:s.set)=="function"?r.mode.set(a?"readonly":"design"):r.setMode(a?"readonly":"design"))}),O(u,function(a){var s;k||(i=r.getContent()),(s=C())===null||s===void 0||s.remove(r),z(function(){return S()})}),K(function(){if(C()!==null)S();else if(c.value&&c.value.ownerDocument){var a=e.cloudChannel?e.cloudChannel:"5",s=e.apiKey?e.apiKey:"no-api-key",y=ce(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+s+"/tinymce/"+a+"/tinymce.min.js":e.tinymceScriptSrc;me.load(c.value.ownerDocument,y,S)}}),W(function(){C()!==null&&C().remove(r)}),b||(J(function(){h||S()}),X(function(){var a;k||(i=r.getContent()),(a=C())===null||a===void 0||a.remove(r)}));var m=function(a){var s;i=r.getContent(),(s=C())===null||s===void 0||s.remove(r),o=w(w({},o),a),z(function(){return S()})};return n.expose({rerender:m}),function(){return b?ge(j,g,c,e.tagName):pe(j,g,c)}}});const U=A(!1),M=()=>{U.value=!1},ye=e=>{let n=localStorage.getItem("token");P({method:"DELETE",url:"/posts/"+e,headers:{Authorization:"Bearer "+n}}).then(o=>{window.location.reload()})},_e={components:{AdminHeaderVue:Z,LoadingOutlined:$,PlusOutlined:ee,editor:he},setup(){const e=[{title:"Title",dataIndex:"title"},{title:"Description",dataIndex:"description"},{title:"Action",dataIndex:"operation",slots:{customRender:"operation"}}],n=A(),o=A();let t="",l=[];const d=A(""),u=A(),c=te({title:"",description:"",link:"",content:""}),r=m=>{U.value=!0;let a=localStorage.getItem("token");P({method:"GET",url:"/posts/"+m+"/edit",headers:{Authorization:"Bearer "+a}}).then(s=>{n.value=s.data.post.id,c.title=s.data.post.title,d.value=s.data.post.image,c.link=s.data.post.link,c.description=s.data.post.description,c.content=s.data.post.content})},g={title:[{required:!0,message:"Please input post title",trigger:"blur"}],description:[{required:!0,message:"Please insert post description",trigger:"blur"}],link:[{required:!0,message:"Please insert link",trigger:"blur"}]},b=()=>{let m=R(c);m.image=t,u.value.validate().then(()=>{let a=localStorage.getItem("token");P({method:"POST",url:"/posts/",headers:{Authorization:"Bearer "+a,"content-type":"multipart/form-data"},data:m}).then(s=>{M(),window.location.reload()})}).catch(a=>{console.log("error",a)})};function k(m){const a=m.target.files[0];t=a,d.value=URL.createObjectURL(a)}const h=()=>{u.value.resetFields()},B=()=>{U.value=!0,h()},i=m=>{let a=localStorage.getItem("token");P({method:"PUT",url:"/posts/"+m,headers:{Authorization:"Bearer "+a},data:R(c)}).then(s=>{let y={id:m,type:"post",image:t};P({method:"POST",url:"/image/update",headers:{Authorization:"Bearer "+a,"content-type":"multipart/form-data"},data:y}).then(V=>{M(),window.location.reload(),U.value=!1})})},x=m=>{P.get("/posts",{headers:{Authorization:"Bearer "+m}}).then(a=>{o.value=a.data.posts,l=a.data.posts})};return K(()=>{let m=localStorage.getItem("token");x(m)}),{data:o,columns:e,visible:U,closeModal:M,updateHandler:i,deleteHandler:ye,formRef:u,labelCol:{span:8},wrapperCol:{span:12},other:"",formState:c,rules:g,onSubmit:b,resetForm:h,imageUrl:d,onFileChange:k,getPosts:x,addNewModal:B,editModal:r,filterByPostName:m=>{o.value=l.filter(a=>a.title.toLowerCase().indexOf(m.target.value.toLowerCase())>-1)},pId:n}}},be={class:"retailers"},ke={class:"container"},Ce={class:"text-right mt-[100px] mb-[10px]"},we=E("Add new"),xe={class:"flex items-center flex-wrap gap-[20px] mb-[20px]"},Se=p("span",null,"Post name: ",-1),Pe=E("Edit"),Ae=E("Delete"),Ee={class:"flex items-center justify-center w-full relative"},Be={key:0,class:"flex flex-col items-center justify-center pt-7"},Ie=["src"],Ue={key:1,class:"flex flex-col w-full h-32 border-4 border-blue-200 border-dashed hover:bg-gray-100 hover:border-gray-300"},De=p("div",{class:"flex flex-col items-center justify-center pt-7"},[p("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-gray-400 group-hover:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),p("p",{class:"pt-1 text-sm tracking-wider text-gray-400 group-hover:text-gray-600"},"Upload image")],-1),Le=[De],Me=E("Update"),Oe=E("Save"),Ve=E("Reset");function je(e,n,o,t,l,d){const u=_("a-button"),c=_("a-table"),r=_("a-input"),g=_("a-form-item"),b=_("editor"),k=_("a-textarea"),h=_("a-form"),B=_("a-modal");return I(),L("div",be,[p("div",ke,[p("div",Ce,[f(u,{class:"mr-[10px]",type:"primary",onClick:t.addNewModal},{default:v(()=>[we]),_:1},8,["onClick"])]),p("div",xe,[p("div",null,[Se,p("input",{onInput:n[0]||(n[0]=i=>t.filterByPostName(i)),class:"py-[10px] border border-[#f5f5f5] px-[10px]",type:"text",placeholder:"Filter by post name"},null,32)])]),f(c,{columns:t.columns,"data-source":t.data,bordered:""},{name:v(({text:i})=>[p("a",null,ne(i),1)]),operation:v(({record:i})=>[f(u,{class:"mr-[10px]",type:"primary",onClick:x=>t.editModal(i.id)},{default:v(()=>[Pe]),_:2},1032,["onClick"]),f(u,{class:"mr-[10px]",type:"danger",onClick:x=>t.deleteHandler(i.id)},{default:v(()=>[Ae]),_:2},1032,["onClick"])]),_:1},8,["columns","data-source"])]),f(B,{visible:t.visible,"onUpdate:visible":n[7]||(n[7]=i=>t.visible=i),class:"!w-full !max-full",title:`${t.pId?"Edit Post":"Add new post"}`},{default:v(()=>[f(h,{ref:"formRef",model:t.formState,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},{default:v(()=>[f(g,{ref:"title",label:"Post title",name:"title"},{default:v(()=>[f(r,{value:t.formState.title,"onUpdate:value":n[1]||(n[1]=i=>t.formState.title=i)},null,8,["value"])]),_:1},512),f(g,{ref:"name",label:"Image",name:"image"},{default:v(()=>[p("div",Ee,[t.imageUrl?(I(),L("div",Be,[p("img",{class:"w-[150px]",src:t.imageUrl},null,8,Ie)])):D("",!0),t.imageUrl?D("",!0):(I(),L("label",Ue,Le)),p("input",{type:"file",name:"image",onChange:n[2]||(n[2]=(...i)=>t.onFileChange&&t.onFileChange(...i)),class:"opacity-0 absolute top-0 left-0 right-0 bottom-0 w-full h-full"},null,32)])]),_:1},512),f(g,{ref:"link",label:"Post external link",name:"link"},{default:v(()=>[f(r,{value:t.formState.link,"onUpdate:value":n[3]||(n[3]=i=>t.formState.link=i)},null,8,["value"])]),_:1},512),f(g,{ref:"description",label:"Content",name:"description"},{default:v(()=>[f(b,{modelValue:t.formState.content,"onUpdate:modelValue":n[4]||(n[4]=i=>t.formState.content=i),"api-key":"tjw4jd9m79ff5a6n1tssaafm7ikn5dtpw1kdn9rza02sd19y",init:{height:500,menubar:!1,plugins:["anchor headings autolink charmap codesample emoticons link lists searchreplace table visualblocks wordcount checklist mediaembed casechange export formatpainter pageembed linkchecker a11ychecker tinymcespellchecker permanentpen powerpaste advtable advcode editimage tableofcontents footnotes mergetags autocorrect typography inlinecss"],toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat"}},null,8,["modelValue"])]),_:1},512),f(g,{ref:"description",label:"Description",name:"description"},{default:v(()=>[f(k,{value:t.formState.description,"onUpdate:value":n[5]||(n[5]=i=>t.formState.description=i),placeholder:"Autosize height with minimum and maximum number of lines","auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1},512),f(g,{"wrapper-col":{span:14,offset:4}},{default:v(()=>[t.pId?(I(),N(u,{key:0,type:"primary",onClick:n[6]||(n[6]=i=>t.updateHandler(t.pId))},{default:v(()=>[Me]),_:1})):D("",!0),t.pId?D("",!0):(I(),N(u,{key:1,type:"primary",onClick:t.onSubmit},{default:v(()=>[Oe]),_:1},8,["onClick"])),f(u,{style:{"margin-left":"10px"},onClick:t.resetForm},{default:v(()=>[Ve]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","label-col","wrapper-col"])]),_:1},8,["visible","title"])])}const Re=Y(_e,[["render",je]]);export{Re as default};
